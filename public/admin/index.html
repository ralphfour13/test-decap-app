<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Flex:opsz,wght@8..144,100..1000&family=Tagesschrift&display=swap"
      rel="stylesheet"
    />
    <link href="./styles.css" type="text/css" rel="stylesheet" />
    <title>Decap CMS Development Test</title>
  </head>
  <body>
    <script src="https://unpkg.com/netlify-cms@latest/dist/netlify-cms.js"></script>
    <script>
      var ONE_DAY = 60 * 60 * 24 * 1000;

      for (var i = 1; i <= 20; i++) {
        var DraggablePagePreview = createClass({
          getInitialState: function () {
            return {
              sections: [],
              draggedElement: null,
              dragOverIndex: null,
            };
          },

          componentDidMount: function () {
            this.updateSections();
          },

          componentDidUpdate: function (prevProps) {
            if (prevProps.entry !== this.props.entry) {
              this.updateSections();
            }
          },

          updateSections: function () {
            var entry = this.props.entry;
            var sections = entry.getIn(["data", "sections"]) || [];

            // Convert to plain JavaScript array
            var sectionsArray = [];
            if (sections.toJS) {
              sectionsArray = sections.toJS();
            } else if (sections.toArray) {
              sectionsArray = sections.toArray().map(function (section) {
                return section.toJS ? section.toJS() : section;
              });
            } else {
              sectionsArray = Array.isArray(sections) ? sections : [];
            }

            console.log("Sections data:", sectionsArray); // Debug log

            this.setState({
              sections: sectionsArray,
            });
          },

          handleDragStart: function (e, section, index) {
            this.setState({
              draggedElement: { section: section, index: index },
            });
            e.dataTransfer.effectAllowed = "move";
          },

          handleDragOver: function (e, index) {
            e.preventDefault();
            this.setState({ dragOverIndex: index });
          },

          handleDragLeave: function () {
            this.setState({ dragOverIndex: null });
          },

          handleDrop: function (e, targetIndex) {
            e.preventDefault();
            var draggedElement = this.state.draggedElement;

            if (draggedElement && draggedElement.index !== targetIndex) {
              var newSections = this.state.sections.slice();
              var movedSection = newSections.splice(draggedElement.index, 1)[0];
              newSections.splice(targetIndex, 0, movedSection);

              this.setState({
                sections: newSections,
                draggedElement: null,
                dragOverIndex: null,
              });

              this.updateCMSEntry(newSections);
            }
          },

          updateCMSEntry: function (newSections) {
            var onChange = this.props.onChange;
            var entry = this.props.entry;
            if (onChange && entry.setIn) {
              var updatedEntry = entry.setIn(
                ["data", "sections"],
                window.Immutable.fromJS(newSections)
              );
              onChange(updatedEntry);
            }
          },

          getTextColor: function (bgColor) {
            if (
              !bgColor ||
              bgColor === "#ffffff" ||
              bgColor === "white" ||
              bgColor === "#fff" ||
              bgColor === "ffffff"
            ) {
              return "#333";
            }

            var color = bgColor.replace("#", "");

            if (color.length === 3) {
              color = color
                .split("")
                .map(function (hex) {
                  return hex + hex;
                })
                .join("");
            }

            if (color.length === 6) {
              var r = parseInt(color.substr(0, 2), 16);
              var g = parseInt(color.substr(2, 2), 16);
              var b = parseInt(color.substr(4, 2), 16);
              var luminance = 0.299 * r + 0.587 * g + 0.114 * b;
              return luminance > 128 ? "#333" : "#fff";
            }

            return "#333";
          },

          getSectionTypeIcon: function (type) {
            switch (type) {
              case "hero":
                return "ðŸ¦¸";
              case "content":
                return "ðŸ“";
              case "gallery":
                return "ðŸ–¼ï¸";
              case "contact":
                return "ðŸ“ž";
              case "custom":
                return "âš™ï¸";
              default:
                return "ðŸ“„";
            }
          },

          getSectionTypeColor: function (type) {
            switch (type) {
              case "hero":
                return "#ff6b6b";
              case "content":
                return "#4ecdc4";
              case "gallery":
                return "#45b7d1";
              case "contact":
                return "#96ceb4";
              case "custom":
                return "#ffeaa7";
              default:
                return "#ddd";
            }
          },

          renderHeroBanner: function (
            section,
            index,
            isDraggedOver,
            isDragging,
            backgroundColor,
            heroTitleColor,
            heroDescColor
          ) {
            const heroTitle = section.hero_section_title || "";
            const heroDesc = section.hero_description || "";

            const cta1Data = section.hero_cta_1 || {};
            const cta2Data = section.hero_cta_2 || {};
            const heroCta1 = cta1Data.btn_text || "";
            const heroCta2 = cta2Data.btn_text || "";
            const buttonUrl_1 = cta1Data.btn_url || "";
            const buttonUrl_2 = cta2Data.btn_url || "";
            const bgColorCta_1 = cta1Data.bg_btn_color || "#ffffff";
            const textColorCta_1 = cta1Data.text_btn_color || "#000000";
            const bgColorCta_2 = cta2Data.bg_btn_color || "#ffffff";
            const textColorCta_2 = cta2Data.text_btn_color || "#000000";

            const hero_image = section.hero_banner_img || "";

            return h(
              "div",
              {
                style: {
                  position: "relative",
                  display: "flex",
                  alignItems: "center",
                  justifyContent: "center",
                  border: isDraggedOver
                    ? "3px dashed #007acc"
                    : "2px solid #ddd",
                  backgroundColor: backgroundColor,
                  opacity: isDragging ? 0.6 : 1,
                  transition: "all 0.3s ease",
                  boxShadow: isDraggedOver
                    ? "0 8px 25px rgba(0,122,204,0.4)"
                    : "0 4px 20px rgba(0,0,0,0.25)",
                  transform: isDragging ? "rotate(1deg)" : "none",
                  overflow: "hidden",
                  backgroundImage: hero_image ? `url(${hero_image})` : "none",
                  backgroundSize: "cover",
                  backgroundRepeat: "no-repeat",
                },
              },
              [
                // Hero background overlay
                h("div", {
                  key: "hero-overlay",
                  style: {
                    position: "absolute",
                    top: 0,
                    left: 0,
                    right: 0,
                    bottom: 0,
                    opacity: 0.3,
                  },
                }),

                // Hero content container
                h(
                  "div",
                  {
                    key: "hero-div" + index,
                    style: {
                      position: "relative",
                      zIndex: 2,
                      textAlign: "center",
                      maxWidth: "800px",
                      padding: "90px 30px",
                      width: "100%",
                    },
                  },
                  [
                    // Main Hero Title
                    h("h1", {
                      className: "hero_section_title" + index,
                      style: {
                        fontSize: "48px",
                        fontWeight: "700",
                        marginBottom: "20px",
                        lineHeight: "1.2",
                        color: heroTitleColor,
                      },
                      dangerouslySetInnerHTML: {
                        __html: heroTitle,
                      },
                    }),

                    h(
                      "h3",
                      {
                        key: "hero_description",
                        style: {
                          fontSize: "22px",
                          fontWeight: "300",
                          color: heroDescColor,
                        },
                      },
                      heroDesc
                    ),

                    h(
                      "div",
                      {
                        style: {
                          display: "flex",
                          gap: "2rem",
                          justifyContent: "center",
                        },
                      },
                      [
                        heroCta1
                          ? h(
                              "a",
                              {
                                key: "column-button-cta1",
                                href: buttonUrl_1 || "#",
                                style: {
                                  display: "inline-block",
                                  backgroundColor: bgColorCta_1,
                                  color: textColorCta_1,
                                  padding: "14px 46px",
                                  borderRadius: "10px",
                                  textDecoration: "none",
                                  fontSize: "22px",
                                  fontWeight: "600",
                                  transition: "all 0.3s ease",
                                  // border: "1.75px solid #fff",
                                  cursor: "pointer",
                                  alignSelf: "center",
                                  maxWidth: "fit-content",
                                },
                                onmouseover: function (e) {
                                  e.target.style.opacity = "0.9";
                                  e.target.style.transform = "translateY(-2px)";
                                },
                                onmouseout: function (e) {
                                  e.target.style.opacity = "1";
                                  e.target.style.transform = "translateY(0)";
                                },
                              },
                              heroCta1
                            )
                          : null,
                        heroCta2
                          ? h(
                              "a",
                              {
                                key: "column-button-cta2",
                                href: buttonUrl_2 || "#",
                                style: {
                                  display: "inline-block",
                                  backgroundColor: bgColorCta_2,
                                  color: textColorCta_2,
                                  padding: "14px 46px",
                                  borderRadius: "10px",
                                  textDecoration: "none",
                                  fontSize: "22px",
                                  fontWeight: "600",
                                  transition: "all 0.3s ease",
                                  border: "1.75px solid #fff",
                                  cursor: "pointer",
                                  alignSelf: "center",
                                  maxWidth: "fit-content",
                                },
                                onmouseover: function (e) {
                                  e.target.style.opacity = "0.9";
                                  e.target.style.transform = "translateY(-2px)";
                                },
                                onmouseout: function (e) {
                                  e.target.style.opacity = "1";
                                  e.target.style.transform = "translateY(0)";
                                },
                              },
                              heroCta2
                            )
                          : null,
                      ]
                    ),
                  ]
                ),
              ]
            );
          },

          // Multicolumn rendering function
          renderMultiColumnSection: function (
            section,
            index,
            isDraggedOver,
            isDragging,
            backgroundColor
          ) {
            const columns = section.columns || [];
            const columnCount = columns.length || 2;
            const sectionTitle = section.title || "";
            const sectionHighlight = section.title_highlight || "";
            const sectionSubtitle = section.description || "";

            return h(
              "div",
              {
                key: "section-" + index,
                style: {
                  position: "relative",
                  minHeight: "300px",
                  backgroundColor: backgroundColor || "#ffffff",
                  opacity: isDragging ? 0.6 : 1,
                  transition: "all 0.3s ease",
                  boxShadow: isDraggedOver
                    ? "0 8px 25px rgba(0,122,204,0.4)"
                    : "0 4px 20px rgba(0,0,0,0.1)",
                  transform: isDragging ? "rotate(1deg)" : "none",
                  overflow: "hidden",
                  padding: "40px 30px",
                },
              },
              [
                // Section header (if title exists)
                sectionTitle
                  ? h(
                      "div",
                      {
                        key: "multicolumn-header",
                        style: {
                          textAlign: "center",
                          marginBottom: "40px",
                        },
                      },
                      [
                        h(
                          "h2",
                          {
                            key: "section-title",
                            style: {
                              fontSize: "36px",
                              fontWeight: "600",
                              marginBottom: "10px",
                              color: "#333",
                              lineHeight: "1.3",
                            },
                          },
                          sectionTitle
                        ),
                        sectionHighlight
                          ? h(
                              "h2",
                              {
                                key: "section-highlight",
                                style: {
                                  fontSize: "36px",
                                  fontWeight: "600",
                                  marginBottom: "10px",
                                  color: "#333",
                                  lineHeight: "1.3",
                                },
                              },
                              sectionHighlight
                            )
                          : null,
                        sectionSubtitle
                          ? h(
                              "p",
                              {
                                key: "section-subtitle",
                                style: {
                                  fontSize: "18px",
                                  color: "#666",
                                  fontWeight: "400",
                                  opacity: "0.8",
                                },
                              },
                              sectionSubtitle
                            )
                          : null,
                      ].filter(Boolean)
                    )
                  : null,

                // Columns container
                h(
                  "div",
                  {
                    key: "columns-container",
                    style: {
                      display: "grid",
                      gridTemplateColumns: `repeat(${Math.min(
                        columnCount,
                        4
                      )}, 1fr)`,
                      gap: "30px",
                      alignItems: "center",
                    },
                  },
                  columns.map((column, colIndex) =>
                    this.renderColumn(column, colIndex)
                  )
                ),
              ].filter(Boolean)
            );
          },

          renderTestimonialSection: function (section, index) {
            const testimonials = section.testimonials || [];

            return h(
              "div",
              {
                key: "section-" + index,
                style: {
                  backgroundColor: "#F7F9FA",
                  marginTop: "3rem",
                },
              },
              [
                h(
                  "div",
                  {
                    style: {
                      display: "grid",
                      gridTemplateColumns: `repeat(${Math.min(2, 4)}, 1fr)`,
                      alignItems: "center",
                      gap: "2rem",
                    },
                  },
                  [
                    h(
                      "div",
                      {
                        key: "testimonials-container" + index,
                        className: "testimonials-grid",
                        style: {
                          display: "grid",
                          gap: "2rem",
                        },
                      },
                      [
                        ...testimonials?.map((testimonial, testimonialIdx) => {
                          return h(
                            "div",
                            {
                              key: "testimonial-" + testimonialIdx,
                              className: "testimonial-card",
                              style: {
                                display: "grid",
                                gap: "1rem",
                                background: "#ffffff",
                              },
                            },
                            [
                              testimonial.star_rating
                                ? h(
                                    "div",
                                    {
                                      className: "star-rating",
                                      style: {
                                        padding: "1rem 1rem 0 1rem",
                                      },
                                    },
                                    [
                                      h(
                                        "span"
                                        // `Rating: ${testimonial.star_rating}/5`
                                      ),
                                      ...Array.from(
                                        {
                                          length: parseInt(
                                            testimonial.star_rating
                                          ),
                                        },
                                        (_, i) =>
                                          h(
                                            "span",
                                            {
                                              key: i,
                                              className: "star",
                                              style: {
                                                color: "#5025AD",
                                              },
                                            },
                                            "â˜…"
                                          )
                                      ),
                                    ]
                                  )
                                : null,
                              testimonial.customer_testimonial
                                ? h(
                                    "p",
                                    {
                                      className: "testimonial-text",
                                      style: {
                                        fontWeight: "600",
                                        fontSize: "14px",
                                        padding: "0 1rem",
                                      },
                                    },
                                    testimonial.customer_testimonial
                                  )
                                : null,
                              h(
                                "div",
                                {
                                  className: "customer-container",
                                  style: {
                                    display: "flex",
                                    background: "#7c63fd",
                                    alignItems: "center",
                                    gap: "1rem",
                                    padding: "1.5rem 1rem",
                                    color: "#fff",
                                    fontWeight: "700",
                                    fontSize: "12px",
                                  },
                                },
                                [
                                  testimonial.customer_image
                                    ? h("img", {
                                        src: testimonial.customer_image,
                                        alt:
                                          testimonial.customer_name ||
                                          "Customer",
                                        className: "customer-image",
                                        style: {
                                          maxWidth: "100%",
                                          width: "50.5px",
                                          height: "50.5px",
                                          borderRadius: "50%",
                                        },
                                      })
                                    : null,
                                  testimonial.customer_name
                                    ? h(
                                        "h4",
                                        {
                                          className: "customer-name",
                                        },
                                        testimonial.customer_name
                                      )
                                    : null,
                                ]
                              ),
                            ]
                          );
                        }),
                      ]
                    ),
                    h(
                      "div",
                      {
                        className: "testimonial-info-container",
                      },
                      [
                        // Main heading
                        h("h3", {
                          style: {
                            fontSize: "36px",
                            fontWeight: "600",
                            marginBottom: "20px",
                            color: "#07051C",
                          },
                          dangerouslySetInnerHTML: {
                            __html:
                              "What <span style='color: #7C63FD;'>Sellers</span> Are <span style='color: #7C63FD;'>Saying</span>",
                          },
                        }),

                        // Subtitle
                        h("p", {
                          style: {
                            fontSize: "22px",
                            color: "#07051C",
                            fontWeight: "300",
                            marginBottom: "50px",
                          },
                          dangerouslySetInnerHTML: {
                            __html:
                              "Join Thousands of Sellersâ€”<span style='color: #5025AD; font-weight: 600;'>Try SellerYard Free!</span>",
                          },
                        }),

                        // Stats container
                        h(
                          "div",
                          {
                            style: {
                              display: "grid",
                              gridTemplateColumns:
                                "repeat(auto-fit, minmax(65px, 1fr))",
                              gap: "40px",
                              maxWidth: "1000px",
                              margin: "0 auto 50px auto",
                            },
                          },
                          [
                            // Stat 1 - Amazon Sellers Served
                            h(
                              "div",
                              {
                                style: {
                                  textAlign: "center",
                                },
                              },
                              [
                                h(
                                  "div",
                                  {
                                    style: {
                                      fontSize: "50px",
                                      fontWeight: "600",
                                      color: "#07051C",
                                      lineHeight: "1",
                                      marginBottom: "10px",
                                    },
                                  },
                                  "00+"
                                ),
                                h(
                                  "p",
                                  {
                                    style: {
                                      fontWeight: "300",
                                      fontSize: "16px",
                                      color: "#07051C",
                                      margin: "0",
                                    },
                                  },
                                  "Amazon Sellers Served"
                                ),
                              ]
                            ),

                            // Stat 2 - ASINs Tracked
                            h(
                              "div",
                              {
                                style: {
                                  textAlign: "center",
                                },
                              },
                              [
                                h(
                                  "div",
                                  {
                                    style: {
                                      fontSize: "50px",
                                      fontWeight: "600",
                                      color: "#07051C",
                                      lineHeight: "1",
                                      marginBottom: "10px",
                                    },
                                  },
                                  "00+"
                                ),
                                h(
                                  "p",
                                  {
                                    style: {
                                      fontWeight: "300",
                                      fontSize: "16px",
                                      color: "#07051C",
                                      margin: "0",
                                    },
                                  },
                                  "ASINs Tracked"
                                ),
                              ]
                            ),

                            // Stat 3 - Leads Tracked
                            h(
                              "div",
                              {
                                style: {
                                  textAlign: "center",
                                },
                              },
                              [
                                h(
                                  "div",
                                  {
                                    style: {
                                      fontSize: "50px",
                                      fontWeight: "600",
                                      color: "#07051C",
                                      lineHeight: "1",
                                      marginBottom: "10px",
                                    },
                                  },
                                  "00+"
                                ),
                                h(
                                  "p",
                                  {
                                    style: {
                                      fontWeight: "300",
                                      fontSize: "16px",
                                      color: "#07051C",
                                      margin: "0",
                                    },
                                  },
                                  "Leads Tracked"
                                ),
                              ]
                            ),

                            // Stat 4 - Combined Revenue
                            h(
                              "div",
                              {
                                style: {
                                  textAlign: "center",
                                },
                              },
                              [
                                h(
                                  "div",
                                  {
                                    style: {
                                      fontSize: "50px",
                                      fontWeight: "600",
                                      color: "#07051C",
                                      lineHeight: "1",
                                      marginBottom: "10px",
                                    },
                                  },
                                  "00+"
                                ),
                                h(
                                  "p",
                                  {
                                    style: {
                                      fontWeight: "300",
                                      fontSize: "16px",
                                      color: "#07051C",
                                      margin: "0",
                                    },
                                  },
                                  "Combined Revenue"
                                ),
                              ]
                            ),
                          ]
                        ),

                        // CTA Button
                        h(
                          "button",
                          {
                            style: {
                              backgroundColor: "#8b5cf6",
                              color: "white",
                              padding: "16px 40px",
                              fontSize: "20px",
                              fontWeight: "600",
                              border: "none",
                              borderRadius: "12px",
                              cursor: "pointer",
                              transition: "all 0.2s ease",
                              boxShadow: "0 4px 12px rgba(139, 92, 246, 0.3)",
                            },
                            onMouseOver: function () {
                              this.style.backgroundColor = "#7c3aed";
                              this.style.transform = "translateY(-2px)";
                            },
                            onMouseOut: function () {
                              this.style.backgroundColor = "#8b5cf6";
                              this.style.transform = "translateY(0)";
                            },
                          },
                          "Start Free Today"
                        ),
                      ]
                    ),
                  ]
                ),
              ]
            );
          },

          // Will render the Pricing section
          renderPricingSection: function (section, index) {
            const priceTitle = section.price_title || "";
            const priceDesc = section.price_desc || "";
            const tier = section.price_row || [];
            console.log("xxxxxxxxx", tier);

            return h(
              "div",
              {
                className: "price-container",
                style: {
                  margin: "0 auto",
                  padding: "40px 30px",
                  background: "#fff",
                },
              },
              [
                h(
                  "div",
                  {
                    className: "price-header",
                    style: {
                      textAlign: "center",
                      marginBottom: "50px",
                    },
                  },
                  [
                    h("h2", {
                      dangerouslySetInnerHTML: {
                        __html: priceTitle,
                      },
                    }),
                    h("p", {
                      className: "price-desc",
                      dangerouslySetInnerHTML: {
                        __html: priceDesc,
                      },
                    }),
                  ]
                ),

                h(
                  "div",
                  {
                    className: "price-grid",
                    style: {
                      display: "grid",
                      gridTemplateColumns:
                        "repeat(auto-fit, minmax(280px, 1fr))",
                      gap: "24px",
                      margin: "0 auto",
                      background:
                        "linear-gradient(359.84deg, #F1EDFC 50%, rgba(255, 255, 255, 0) 128.12%)",
                      padding: "60px 68px",
                      borderRadius: "26px",
                    },
                  },

                  tier.map((item) => {
                    return h(
                      "div",
                      {
                        className: "price-card",
                        style: {
                          background: "rgba(255, 255, 255, 0.1)",
                          backdropFilter: "blur(20px)",
                          borderRadius: "20px",
                          display: "flex",
                          flexDirection: "column",
                          gap: "1rem",
                          cursor: "pointer",
                        },
                      },
                      [
                        h(
                          "div",
                          {
                            className: "tier-name",
                            style: {
                              color: "#3A2273",
                              fontSize: "24px",
                              fontWeight: "400",
                            },
                          },
                          item?.tier
                        ),
                        h(
                          "div",
                          {
                            className: "price",
                          },
                          [
                            h(
                              "span",
                              {
                                className: "price-amount",
                                style: {
                                  color: "#3A2273",
                                  fontSize: "36px",
                                  fontWeight: "600",
                                },
                              },
                              item?.monthly_price
                            ),
                            h("span", {
                              className: "price-period",
                              style: {
                                color: "#797B87",
                                fontSize: "22px",
                                fontWeight: "300",
                              },
                              dangerouslySetInnerHTML: {
                                __html:
                                  item?.monthly_price !== "Custom"
                                    ? "/month"
                                    : "",
                              },
                            }),
                          ]
                        ),
                        h(
                          "div",
                          {
                            className: "tier-info",
                            style: {
                              color: "#5025AD",
                              fontSize: "16px",
                              fontWeight: "600",
                            },
                          },
                          item?.tier_info
                        ),
                        h(
                          "div",
                          {
                            className: "features-title",
                            style: {
                              color: "#000000",
                              fontSize: "12px",
                              fontWeight: "700",
                            },
                          },
                          //need to update
                          "Key Features"
                        ),
                        h(
                          "ul",
                          {
                            className: "features-list",
                          },
                          [
                            item?.key_features?.map((feature) => {
                              return h("li", {
                                className: "feature-item",
                                style: {
                                  fontSize: "16px",
                                  fontWeight: "600",
                                },
                                dangerouslySetInnerHTML: {
                                  __html: feature?.feature_title,
                                },
                              });
                            }),
                          ]
                        ),
                        h(
                          "div",
                          {
                            className: "disclaimer",
                            style: {
                              color: "#575A69",
                              fontSize: "12px",
                              fontWeight: "300",
                            },
                          },
                          "*Whichever Comes First"
                        ),
                        h(
                          "a",
                          {
                            href: item?.price_button?.btn_url ?? "#",
                            target: "_blank",
                            className: "price-cta",
                            style: {
                              backgroundColor:
                                item?.price_button?.bg_btn_color || "#ffffff",
                              color:
                                item?.price_button?.text_btn_color || "#000000",
                              textDecoration: "none",
                              borderRadius: "10px",
                              fontSize: "22px",
                              fontWeight: "600",
                              maxWidth: "300px",
                              textAlign: "center",
                              padding: "1rem",
                              minWidth: "fit-content",
                            },
                          },
                          item?.price_button?.btn_text
                        ),
                      ]
                    );
                  })
                ),
              ]
            );
          },

          renderWrappedImage: function (section, index) {
            const wrappedImg = section?.wrapped_image || "";
            const imgAltText = section?.alt_text || "";

            return h("img", {
              key: "wrapped-image" + index,
              src: wrappedImg,
              alt: imgAltText,
              style: {
                width: "100%",
              },
            });
          },

          renderColumn: function (column, colIndex) {
            const columnType = column.type;

            if (columnType === "image") {
              return this.renderImageColumn(column, colIndex);
            } else if (columnType === "content") {
              return this.renderContentColumn(column, colIndex);
            }

            return null;
          },

          renderImageColumn: function (column, colIndex) {
            const imageUrl = column.image_url;
            const altText = column.alt_text || "";
            const width = column.width || "600";
            const height = column.height || "400";

            if (!imageUrl) return null;

            return h(
              "div",
              {
                key: "image-column-" + colIndex,
                style: {
                  display: "flex",
                  justifyContent: "center",
                  alignItems: "center",
                },
              },
              [
                h("img", {
                  key: "column-image",
                  src: imageUrl,
                  alt: altText,
                  style: {
                    maxWidth: "100%",
                    height: "auto",
                    width: width + "px",
                    maxHeight: height + "px",
                    borderRadius: "10px",
                    boxShadow: "0 4px 15px rgba(0,0,0,0.1)",
                    objectFit: "cover",
                  },
                }),
              ]
            );
          },

          renderContentColumn: function (column, colIndex) {
            const columnTitle = column.title || "";
            const titleHighlight = column.title_highlight || "";
            const titleHighlightColor =
              column.title_highlight_color || "#8b5cf6";
            const columnDescription = column.description || "";
            const columnImage = column.image_url || "";

            // Button properties from the column
            const buttonData = column.button || {};
            const buttonText = buttonData.btn_text || "";
            const buttonUrl = buttonData.btn_url || "";
            const buttonBackgroundColor = buttonData.bg_btn_color || "#ffffff";
            const buttonTextColor = buttonData.text_btn_color || "#000000";

            return h(
              "div",
              {
                key: "column-" + colIndex,
                style: {
                  padding: "20px",
                  textAlign: column.text_align || "center",
                  display: "flex",
                  flexDirection: "column",
                  gap: "15px",
                },
              },
              [
                // Column image (if exists)
                columnImage
                  ? h("img", {
                      key: "column-image-" + colIndex,
                      src: columnImage,
                      style: {
                        width: "100%",
                        height: "auto",
                        borderRadius: "8px",
                        marginBottom: "15px",
                      },
                    })
                  : null,

                // Column title
                columnTitle
                  ? h("h3", {
                      key: "column-title-" + colIndex,
                      style: {
                        fontSize: "24px",
                        fontWeight: "600",
                        marginBottom: "10px",
                        color: "#333",
                      },
                      dangerouslySetInnerHTML: {
                        __html: columnTitle,
                      },
                    })
                  : null,
                titleHighlight
                  ? h(
                      "h3",
                      {
                        key: "column-highlight",
                        style: {
                          fontSize: "28px",
                          fontWeight: "700",
                          marginBottom: "15px",
                          color: titleHighlightColor,
                          lineHeight: "1.3",
                        },
                      },
                      titleHighlight
                    )
                  : null,

                // Column description
                columnDescription
                  ? h("p", {
                      key: "column-description-" + colIndex,
                      style: {
                        fontSize: "16px",
                        color: "#666",
                        lineHeight: "1.6",
                        margin: "0",
                        marginBottom: buttonText ? "20px" : "0",
                      },
                      dangerouslySetInnerHTML: {
                        __html: columnDescription,
                      },
                    })
                  : null,

                // Column button (if button text exists)
                buttonText
                  ? h(
                      "a",
                      {
                        key: "column-button-" + colIndex,
                        href: buttonUrl || "#",
                        style: {
                          display: "inline-block",
                          backgroundColor: buttonBackgroundColor,
                          color: buttonTextColor,
                          padding: "14px 46px",
                          borderRadius: "10px",
                          textDecoration: "none",
                          fontSize: "22px",
                          fontWeight: "600",
                          transition: "all 0.3s ease",
                          border: "none",
                          cursor: "pointer",
                          alignSelf:
                            column.text_align === "left"
                              ? "flex-start"
                              : column.text_align === "right"
                              ? "flex-end"
                              : "center",
                          maxWidth: "fit-content",
                        },
                        onmouseover: function (e) {
                          e.target.style.opacity = "0.9";
                          e.target.style.transform = "translateY(-2px)";
                        },
                        onmouseout: function (e) {
                          e.target.style.opacity = "1";
                          e.target.style.transform = "translateY(0)";
                        },
                      },
                      buttonText
                    )
                  : null,
              ].filter(Boolean)
            );
          },

          renderSection: function (section, index) {
            const self = this;
            const isDraggedOver = this.state.dragOverIndex === index;
            const isDragging =
              this.state.draggedElement &&
              this.state.draggedElement.index === index;

            // Get the background color from the section data
            const backgroundColor = section.bg_color || "#ffffff";
            const textColor =
              section.text_color || this.getTextColor(backgroundColor);
            const sectionType = section.type || "content";

            const heroTitleColor = section.hero_title_color || "#ffffff";
            const heroDescColor = section.hero_desc_color || "#ffffff";

            let heroStyles = "";

            // Ensure colors have # prefix if they don't already
            if (backgroundColor && !backgroundColor.startsWith("#")) {
              backgroundColor = "#" + backgroundColor;
            }
            if (textColor && !textColor.startsWith("#")) {
              textColor = "#" + textColor;
            }

            // Style depending on sectionType
            if (sectionType && sectionType === "hero") {
              return this.renderHeroBanner(
                section,
                index,
                isDraggedOver,
                isDragging,
                backgroundColor,
                heroTitleColor,
                heroDescColor
              );
            }

            if (sectionType && sectionType === "multi_column") {
              return this.renderMultiColumnSection(
                section,
                index,
                isDraggedOver,
                isDragging,
                backgroundColor
              );
            }

            if (sectionType && sectionType === "testimonials") {
              return this.renderTestimonialSection(
                section,
                index,
                isDraggedOver,
                isDragging,
                backgroundColor
              );
            }

            if (sectionType && sectionType === "wrapped_image") {
              return this.renderWrappedImage(
                section,
                index,
                isDraggedOver,
                isDragging,
                backgroundColor
              );
            }

            if (sectionType && sectionType === "pricing") {
              return this.renderPricingSection(
                section,
                index,
                isDraggedOver,
                isDragging,
                backgroundColor
              );
            }

            return h(
              "div",
              {
                key: "section-" + index,
                style: {
                  ...heroStyles,
                  padding: "20px",
                  margin: "10px 0",
                  border: isDraggedOver
                    ? "3px dashed #007acc"
                    : "2px solid #ddd",
                  borderRadius: "10px",
                  backgroundColor: backgroundColor,
                  opacity: isDragging ? 0.6 : 1,
                  transition: "all 0.3s ease",
                  position: "relative",
                  color: textColor,
                  boxShadow: isDraggedOver
                    ? "0 4px 12px rgba(0,122,204,0.3)"
                    : "0 2px 8px rgba(0,0,0,0.15)",
                  transform: isDragging ? "rotate(2deg)" : "none",
                  borderLeft:
                    "5px solid " + this.getSectionTypeColor(sectionType),
                },
              },
              [
                // Section content
                h(
                  "div",
                  {
                    key: "content",
                    style: {
                      paddingRight: "35px",
                      paddingLeft: "40px",
                      paddingTop: "15px",
                    },
                  },
                  [
                    // Color information panel
                    h(
                      "div",
                      {
                        key: "color-info",
                        style: {
                          marginBottom: "15px",
                          padding: "10px 12px",
                          backgroundColor:
                            textColor === "#fff" || textColor === "#ffffff"
                              ? "rgba(255,255,255,0.15)"
                              : "rgba(0,0,0,0.08)",
                          borderRadius: "8px",
                          fontSize: "11px",
                          color: textColor,
                          fontFamily: "monospace",
                          border:
                            "1px solid " +
                            (textColor === "#fff" || textColor === "#ffffff"
                              ? "rgba(255,255,255,0.3)"
                              : "rgba(0,0,0,0.15)"),
                          display: "flex",
                          justifyContent: "space-between",
                          alignItems: "center",
                        },
                      },
                      [
                        h(
                          "span",
                          { key: "bg-color" },
                          "ðŸŽ¨ Background: " + backgroundColor
                        ),
                        h(
                          "span",
                          { key: "text-color" },
                          "âœï¸ Text: " + textColor
                        ),
                      ]
                    ),

                    h("div", {
                      key: "body",
                      style: {
                        color: textColor,
                        lineHeight: "1.6",
                        fontSize: "14px",
                        backgroundColor: "rgba(255,255,255,0.05)",
                        padding: "15px",
                        borderRadius: "6px",
                        border: "1px solid rgba(255,255,255,0.1)",
                      },
                      dangerouslySetInnerHTML: {
                        __html:
                          section.content ||
                          "<p><em>No content added yet for this " +
                            sectionType +
                            " section...</em></p>",
                      },
                    }),
                  ]
                ),
              ]
            );
          },

          render: function () {
            var self = this;
            var entry = this.props.entry;
            var sections = this.state.sections;
            var title = entry.getIn(["data", "title"]) || "Untitled Blog Post";

            return h(
              "div",
              {
                style: {
                  fontFamily: "'Helvetica Neue', Helvetica, Arial, sans-serif",
                  margin: "0 auto",
                  backgroundColor: "#f8f9fa",
                  minHeight: "100vh",
                  minWidth: "550px",
                },
              },
              [
                // Header
                h(
                  "div",
                  {
                    key: "header",
                    style: {
                      borderBottom: "3px solid #007acc",
                      paddingBottom: "20px",
                      marginBottom: "30px",
                      backgroundColor: "white",
                      padding: "25px",
                      borderRadius: "10px",
                      boxShadow: "0 4px 12px rgba(0,0,0,0.1)",
                    },
                  },
                  [
                    h(
                      "h1",
                      {
                        key: "title",
                        style: {
                          color: "#007acc",
                          margin: "0 0 10px 0",
                          fontSize: "32px",
                          fontWeight: "bold",
                        },
                      },
                      title
                    ),
                    h(
                      "p",
                      {
                        key: "instruction",
                        style: {
                          color: "#666",
                          fontSize: "14px",
                          margin: 0,
                          fontStyle: "italic",
                        },
                      },
                      "âœ‹ Drag sections to reorder â€¢ Background & text colors applied from fields â€¢ Section types shown with icons â€¢ Changes save automatically"
                    ),
                  ]
                ),

                // Sections
                h(
                  "div",
                  {
                    key: "sections",
                  },
                  sections.length > 0
                    ? sections.map(this.renderSection.bind(this))
                    : h(
                        "div",
                        {
                          style: {
                            padding: "60px 40px",
                            textAlign: "center",
                            color: "#666",
                            fontStyle: "italic",
                            border: "3px dashed #ddd",
                            borderRadius: "10px",
                          },
                        },
                        "ðŸ“ No sections added yet. Add sections to see them with background colors and section types!"
                      )
                ),

                // Order summary
                sections.length > 1
                  ? h(
                      "div",
                      {
                        key: "order",
                        style: {
                          marginTop: "30px",
                          padding: "20px",
                          borderRadius: "10px",
                          borderLeft: "5px solid #28a745",
                          boxShadow: "0 2px 8px rgba(0,0,0,0.1)",
                        },
                      },
                      [
                        h(
                          "h4",
                          {
                            key: "order-title",
                            style: { margin: "0 0 15px 0", color: "#28a745" },
                          },
                          "ðŸ“‹ Section Order:"
                        ),
                        h(
                          "div",
                          {
                            key: "order-list",
                            style: {
                              display: "flex",
                              flexWrap: "wrap",
                              gap: "8px",
                            },
                          },
                          sections.map(function (section, index) {
                            return h(
                              "span",
                              {
                                key: "bg_color",
                                style: {
                                  display: "inline-flex",
                                  alignItems: "center",
                                  gap: "6px",
                                  padding: "8px 14px",
                                  backgroundColor:
                                    section.bg_color || "#f8f9fa",
                                  color:
                                    section.text_color ||
                                    self.getTextColor(
                                      section.bg_color || "#f8f9fa"
                                    ),
                                  borderRadius: "20px",
                                  fontSize: "12px",
                                  border:
                                    "2px solid " +
                                    self.getSectionTypeColor(
                                      section.type || "content"
                                    ),
                                  fontWeight: "bold",
                                  boxShadow: "0 2px 4px rgba(0,0,0,0.1)",
                                  textTransform: "uppercase",
                                },
                              },
                              [
                                index + 1 + ".",
                                self.getSectionTypeIcon(
                                  section.type || "content"
                                ),
                                section.type || "Untitled",
                              ]
                            );
                          })
                        ),
                      ]
                    )
                  : null,
              ]
            );
          },
        });

        var date = new Date();
        date.setTime(date.getTime() + ONE_DAY);
        var month = ("0" + (date.getMonth() + 1)).slice(-2);
        var day = ("0" + date.getDate()).slice(-2);
        var dateString = "" + date.getFullYear() + "-" + month + "-" + day;
        var slug = dateString + "-post-number-" + i + ".md";

        // window.repoFiles._posts[slug] = {
        //   content:
        //     '---\ntitle: "This is post # ' +
        //     i +
        //     `\"\ndraft: ${i % 2 === 0}` +
        //     "\ndate: " +
        //     dateString +
        //     "T00:00:00.000Z\n---\n\n# The post is number " +
        //     i +
        //     "\n\nAnd this is yet another identical post body",
        // };
      }

      for (var i = 1; i <= 5; i++) {
        var date = new Date();
        date.setTime(date.getTime() + ONE_DAY);
        var month = ("0" + (date.getMonth() + 1)).slice(-2);
        var day = ("0" + date.getDate()).slice(-2);
        var dateString = "" + date.getFullYear() + "-" + month + "-" + day;
        var slug = dateString + "-faq-number-" + i + ".md";

        // window.repoFiles._faqs[slug] = {
        //   content:
        //     '---\ntitle: "This FAQ item # ' +
        //     i +
        //     '"\ndate: ' +
        //     dateString +
        //     "T00:00:00.000Z\n---\n\n# Loren ipsum dolor sit amet",
        // };
      }

      window.repoFiles._pages = {
        directory: {
          "sub-directory": {
            "nested-directory": {
              "index.md": {
                path: "_pages/directory/sub-directory/nested-directory/index.md",
                content: '---\ntitle: "Nested Directory"\n---\n',
              },
            },
            "index.md": {
              path: "_pages/directory/sub-directory/index.md",
              content: '---\ntitle: "Sub Directory"\n---\n',
            },
          },
          "another-sub-directory": {
            "index.md": {
              path: "_pages/directory/another-sub-directory/index.md",
              content: '---\ntitle: "Another Sub Directory"\n---\n',
            },
          },
          "index.md": {
            path: "_pages/directory/index.md",
            content: '---\ntitle: "Directory"\n---\n',
          },
        },
        "index.md": {
          path: "_pages/index.md",
          content: '---\ntitle: "Root Page"\n---\n',
        },
      };
    </script>
    <script>
      var PostPreview = createClass({
        render: function () {
          var entry = this.props.entry;

          return h(
            "div",
            {},
            h(
              "div",
              { className: "cover" },
              h("h1", {}, entry.getIn(["data", "title"])),
              this.props.widgetFor("image")
            ),
            h(
              "p",
              {},
              h("small", {}, "Written " + entry.getIn(["data", "date"]))
            ),
            h("div", { className: "text" }, this.props.widgetFor("body"))
          );
        },
      });

      var GeneralPreview = createClass({
        render: function () {},
      });

      var AuthorsPreview = createClass({
        render: function () {
          return h(
            "div",
            {},
            h("h1", {}, "Authors"),
            this.props.widgetsFor("authors").map(function (author, index) {
              return h(
                "div",
                { key: index },
                h("hr", {}),
                h("strong", {}, author.getIn(["data", "name"])),
                author.getIn(["widgets", "description"])
              );
            })
          );
        },
      });

      const previewStyles = `
        .cms-editor-visual * {
          box-sizing: border-box;
        }

        .cms-editor-visual img {
          max-width: 100%;
          height: auto;
        }

        .cms-editor-visual h1,
        .cms-editor-visual h2,
        .cms-editor-visual h3,
        .cms-editor-visual h4,
        .cms-editor-visual h5,
        .cms-editor-visual h6 {
          margin-top: 0;
        }

        .cms-editor-visual p {
          margin-bottom: 1em;
        }
      `;

      CMS.registerPreviewTemplate("blog", PostPreview);
      CMS.registerPreviewTemplate("general", GeneralPreview);
      CMS.registerPreviewTemplate("authors", AuthorsPreview);
      CMS.registerPreviewStyle(previewStyles, { raw: true });

      CMS.registerPreviewTemplate("pages", DraggablePagePreview);
      CMS.registerPreviewTemplate("blog", DraggablePagePreview);
      CMS.registerPreviewTemplate("homepage", DraggablePagePreview);
    </script>

    <style>
      .feature-blue-text {
        color: #5025ad !important;
      }
    </style>
  </body>
</html>
